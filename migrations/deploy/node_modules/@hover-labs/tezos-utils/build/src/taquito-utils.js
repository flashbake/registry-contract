"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getTezos = exports.getSigner = void 0;
const taquito_1 = require("@taquito/taquito");
const signer_1 = require("@taquito/signer");
const tzip16_1 = require("@taquito/tzip16");
const PRIVATE_KEY_NAME = 'DEPLOY_SK';
let INITIALIZED = false;
const getSigner = async (config) => {
    const privateKey = process.env[PRIVATE_KEY_NAME] || '';
    if (privateKey === '') {
        throw new Error(`Private key envar ${PRIVATE_KEY_NAME} must be set for operation!`);
    }
    const signer = await signer_1.InMemorySigner.fromSecretKey(privateKey);
    await revealIfNeeded(privateKey, config);
    return signer;
};
exports.getSigner = getSigner;
const getTezos = async (config) => {
    if (INITIALIZED === true) {
        throw new Error("TezosToolkit should be a singleton.");
    }
    INITIALIZED = true;
    const signer = await (0, exports.getSigner)(config);
    const tezos = new taquito_1.TezosToolkit(config.tezosNodeUrl);
    tezos.setProvider({ signer });
    tezos.addExtension(new tzip16_1.Tzip16Module());
    console.log(`Tezos initialized with signer: ${await signer.publicKeyHash()}`);
    return tezos;
};
exports.getTezos = getTezos;
const revealIfNeeded = async (privateKey, config) => {
};
//# sourceMappingURL=taquito-utils.js.map